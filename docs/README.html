<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.17">
<title>Kawa web collection</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Kawa web collection</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_goals_and_target_audience">Goals and target audience</a></li>
<li><a href="#_prerequisites">Prerequisites</a></li>
<li><a href="#_setting_up">Setting up</a></li>
<li><a href="#_modules">Modules</a></li>
<li><a href="#_db_utils">DB Utils</a>
<ul class="sectlevel2">
<li><a href="#_maven_dependencies">Maven dependencies</a></li>
<li><a href="#_exported_procedures">Exported procedures</a></li>
</ul>
</li>
<li><a href="#_interface_abstraction_for_a_set_of_functions">Interface abstraction for a set of functions</a>
<ul class="sectlevel2">
<li><a href="#_maven_dependencies_2">Maven dependencies</a></li>
<li><a href="#_exported_procedures_2">Exported procedures</a></li>
</ul>
</li>
<li><a href="#_mustache_templating">Mustache templating</a>
<ul class="sectlevel2">
<li><a href="#_maven_dependencies_3">Maven dependencies</a></li>
<li><a href="#_base_usage">Base usage</a></li>
<li><a href="#_behavior_customization">Behavior customization</a></li>
</ul>
</li>
<li><a href="#_slf4j_logging_api">SLF4J logging API</a>
<ul class="sectlevel2">
<li><a href="#_maven_dependencies_4">Maven dependencies</a></li>
<li><a href="#_exported_procedures_3">Exported procedures</a></li>
</ul>
</li>
<li><a href="#_solrj">Solrj</a>
<ul class="sectlevel2">
<li><a href="#_maven_dependencies_5">Maven dependencies</a></li>
<li><a href="#_exported_procedures_4">Exported procedures</a></li>
</ul>
</li>
<li><a href="#_solr_embedded">Solr embedded</a>
<ul class="sectlevel2">
<li><a href="#_maven_dependencies_6">Maven dependencies</a></li>
<li><a href="#_exported_procedures_5">Exported procedures</a></li>
</ul>
</li>
<li><a href="#_spark_web_server">Spark web server</a>
<ul class="sectlevel2">
<li><a href="#_maven_dependencies_7">Maven dependencies</a></li>
<li><a href="#_exported_procedures_6">Exported procedures</a></li>
</ul>
</li>
<li><a href="#_password_encoder">Password encoder</a>
<ul class="sectlevel2">
<li><a href="#_maven_dependencies_8">Maven dependencies</a></li>
<li><a href="#_exported_procedures_7">Exported procedures</a></li>
</ul>
</li>
<li><a href="#_srfi_180_json">SRFI 180 (json)</a>
<ul class="sectlevel2">
<li><a href="#_maven_dependencies_9">Maven dependencies</a></li>
<li><a href="#_exported_procedures_8">Exported procedures</a></li>
</ul>
</li>
<li><a href="#_wishlist">Wishlist</a></li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Project versioned at <a href="https://github.com/arvyy/kawa-web-collection" class="bare">https://github.com/arvyy/kawa-web-collection</a></p>
</div>
<div class="paragraph">
<p>Compiled documentation can be viewed at <a href="https://arvyy.github.io/kawa-web-collection/README.html" class="bare">https://arvyy.github.io/kawa-web-collection/README.html</a></p>
</div>
<div class="paragraph">
<p>If you want inspiration on how a real project might look like using this collection, checkout scheme index <a href="https://github.com/arvyy/r7rs-index-site" class="bare">https://github.com/arvyy/r7rs-index-site</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_goals_and_target_audience">Goals and target audience</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Kawa web collection is an attempt to take mature and feature-complete web libraries and tooling, put them in a minimal wrapper, and enable them to be used through vanilla R7RS syntax.
All modules below are optional; you pay in final-artifact size cost only for what you choose to use.</p>
</div>
<div class="paragraph">
<p>If you want to create web applications using Scheme, and don&#8217;t mind learning maven, hopefully this collection will be just for you.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_prerequisites">Prerequisites</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You must have these tools installed (commonly available through package managers)</p>
</div>
<div class="ulist">
<ul>
<li>
<p>JDK 11 (test by running <code>javac -version</code>)</p>
</li>
<li>
<p>Maven 3 (test by running <code>mvn -version</code>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You should eventually read up about maven in general (<a href="https://maven.apache.org/guides/getting-started/" class="bare">https://maven.apache.org/guides/getting-started/</a>) and maven kawa plugin (<a href="https://github.com/arvyy/kawa-maven-plugin" class="bare">https://github.com/arvyy/kawa-maven-plugin</a>),
however if you use project generation command below, it will output all command line commands you need to run and package the application.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_setting_up">Setting up</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Run <code>mvn install</code> from the root of this repository to install collection in local maven repository, which will make individual modules available for local machine.</p>
</div>
<div class="paragraph">
<p>To generate a scaffold project, navigate to some directory, and execute</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>mvn archetype:generate "-DarchetypeGroupId=com.github.arvyy.kawa-web-collection" "-DarchetypeArtifactId=auth-archetype" "-DarchetypeVersion=0.0.1"</code></pre>
</div>
</div>
<div class="paragraph">
<p>When asked for groupId enter some domain you control, when asked for artifactId enter a short name for the project.</p>
</div>
<div class="paragraph">
<p>This will create a simple application, that includes RDBS based authorization system (including proper password salting and hashing), MPA web interface, loggin with Logback.
To add other dependencies, use maven dependency block mentioned under each module, and paste it under <code>&lt;dependencies&gt;</code> tag. Likewise, if you don&#8217;t need some of the dependencies in the scaffold,
remove corresponding <code>&lt;dependency&gt;</code> entry.</p>
</div>
<div class="paragraph">
<p>As mentioned, generated project will include a slim readme file, containing most important CLI commands to run and compile.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_modules">Modules</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_db_utils">DB Utils</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Module for interacting with relational databases through JDBC drivers. A thin wrapper of Apache DbUtils.</p>
</div>
<div class="sect2">
<h3 id="_maven_dependencies">Maven dependencies</h3>
<div class="paragraph">
<p>To include module itself, add following dependency.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&lt;dependency&gt;
    &lt;groupId&gt;com.github.arvyy.kawa-web-collection&lt;/groupId&gt;
    &lt;artifactId&gt;dbutils&lt;/artifactId&gt;
    &lt;packaging&gt;kawalib&lt;/packaging&gt;
    &lt;version&gt;0.0.1&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note, however, this alone is not enough. As mentioned, this operates through JDBC, and therefore you&#8217;ll also have to include
an appropriate JDBC driver for the kind of DB you plan using. For example, to use sqlite, you&#8217;d also add</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&lt;dependency&gt;
    &lt;groupId&gt;org.xerial&lt;/groupId&gt;
    &lt;artifactId&gt;sqlite-jdbc&lt;/artifactId&gt;
    &lt;version&gt;3.32.3.2&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_exported_procedures">Exported procedures</h3>
<div class="sect3">
<h4 id="_library_arvyy_dbutils">Library <code>(arvyy dbutils)</code></h4>
<div class="paragraph">
<p><code>(make-query-runner driver url username password) &#8594; query-runner</code></p>
</div>
<div class="paragraph">
<p>constructs query runner with given connection details to a database. <code>driver</code> is a driver java class name, and will depend
on database / JDBC (eg for sqlite this would be "org.sqlite.JDBC"). <code>url</code> is the jdbc url, which specifies database location and other properties.
As with driver, also entirely depends on database (eg for sqlite "jdbc:sqlite:testdb"). <code>username</code> and <code>password</code> are credentials as strings, used for connection.
If DB isn&#8217;t protected, these strings may be empty.</p>
</div>
<div class="paragraph">
<p><code>(query query-runner sql handler arg &#8230;&#8203;) &#8594; query-result</code></p>
</div>
<div class="paragraph">
<p>execute a query (ie, <code>select</code> statement). <code>query-runner</code> is an object as constructed with <code>make-query-runner</code>. <code>sql</code> is SQL statement as a string. The statement
may have placeholders in using <code>?</code> (eg., <code>select * from users where name = ?</code>). During execution, each <code>?</code> placeholder is replaced with positionally corresponding <code>arg</code>.
<code>handler</code> is what handles database result and transforms it to the value, which is what ultimately gets returned from <code>query</code> call (see <code>handler/*</code> procedures below for handler construction).</p>
</div>
<div class="paragraph">
<p><code>(handler/scalar) &#8594; handler</code></p>
</div>
<div class="paragraph">
<p>creates a scalar handler, which expects for the query to have returned 1 row, and simply returns said row&#8217;s value of first column. If query had returned
0 or 2+ rows, a <code>dbutils-error?</code> is raised.</p>
</div>
<div class="paragraph">
<p><code>(handler/single-of row-handler) &#8594; handler</code></p>
</div>
<div class="paragraph">
<p>creates a handler, which expects for the query to have returned 1 row, and maps the row in accordance to <code>row-handler</code> before returning (see <code>row-handler/*</code> procedures below for row-handler construction).</p>
</div>
<div class="paragraph">
<p><code>(handler/list-of row-handler) &#8594; handler</code></p>
</div>
<div class="paragraph">
<p>creates a handler which maps the rows in accordance to <code>row-handler</code>, and returns them as a list (see <code>row-handler/*</code> procedures below for row-handler construction).</p>
</div>
<div class="paragraph">
<p><code>(handler/generator-of row-handler consumer) &#8594; handler</code></p>
</div>
<div class="paragraph">
<p>creates a handler which defers reading of the rows and creates a generator (ie, thunk, which when called repeatedly keeps returning next value, or <code>eof-object</code> if the values were exhausted), with generator producing values in accordance to <code>row-handler</code>. The result of <code>query</code> using this handler is <code>(consumer generator)</code>. (see <code>row-handler/*</code> procedures below for row-handler construction).</p>
</div>
<div class="paragraph">
<p><code>(row-handler/vector) &#8594; row-handler</code></p>
</div>
<div class="paragraph">
<p>creates a row handler, which reads a row into a <code>vector</code>.</p>
</div>
<div class="paragraph">
<p><code>(row-handler/alist) &#8594; row-handler</code></p>
</div>
<div class="paragraph">
<p>creates a row handler, which reads a row into an alist, using symbol to represent column name.</p>
</div>
<div class="paragraph">
<p><code>(update query-runner sql arg &#8230;&#8203;) &#8594; count</code></p>
</div>
<div class="paragraph">
<p>executes an update (either DML, or a DDL statement), and returns a number of affected rows. <code>query-runner</code> is an object as constructed with
<code>make-query-runner</code>. <code>sql</code> is SQL statement as a string. The statement may have placeholders in using <code>?</code>
(eg., <code>update users set name = ? where name = ?</code>). During execution, each <code>?</code> placeholder is replaced with positionally corresponding <code>arg</code>.</p>
</div>
<div class="paragraph">
<p><code>(insert query-runner sql arg &#8230;&#8203;) &#8594; new-id</code></p>
</div>
<div class="paragraph">
<p>same as <code>update</code>, except only usable with sql insert statement, and returned value corresponds to inserted row&#8217;s generated id if the table has autoincrement.</p>
</div>
<div class="paragraph">
<p><code>(call-in-transaction query-runner use-existing? thunk)</code></p>
</div>
<div class="paragraph">
<p>invokes <code>thunk</code> and for its duration executes SQL statements inside a single transaction, and returns whatever <code>thunk</code> returns.
<code>query-runner</code> is an object as constructed with <code>make-query-runner</code>.
<code>use-existing?</code> specifies what do in the case when current context is already in transaction - if <code>#f</code>, a new transaction is started.
When using <code>call-in-transaction</code>, it&#8217;s users responsibility to commit (or rollback) for the changes to take place, see <code>commit</code> and <code>rollback</code> below.
If an uncaught exception gets raised by thunk, transaction is automatically rolled back.</p>
</div>
<div class="paragraph">
<p><code>(in-transaction?) &#8594; boolean</code></p>
</div>
<div class="paragraph">
<p>returns if we&#8217;re in a transaction context started by a <code>call-in-transaction</code>.</p>
</div>
<div class="paragraph">
<p><code>(commit)</code></p>
</div>
<div class="paragraph">
<p><code>(rollback)</code></p>
</div>
<div class="paragraph">
<p>Commit / rollback current transaction. Raises an error if <code>in-transaction?</code> is false.</p>
</div>
<div class="paragraph">
<p><code>(dbutils-error? obj) &#8594; boolean</code></p>
</div>
<div class="paragraph">
<p>return whether or not given object is an error caused by DB interaction.</p>
</div>
<div class="paragraph">
<p><code>(dbutils-error-message err) &#8594; string</code></p>
</div>
<div class="paragraph">
<p>returns error&#8217;s message.</p>
</div>
<div class="paragraph">
<p><code>(dbutils-error-statement sql) &#8594; string</code></p>
</div>
<div class="paragraph">
<p>returns sql statement, execution of which caused the error</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_interface_abstraction_for_a_set_of_functions">Interface abstraction for a set of functions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This library provides a way to define an interface (a set of procedures with defined names and parameter count), define interface&#8217;s implementation(s), and call interface method with specific implementation reference.</p>
</div>
<div class="paragraph">
<p>While generally interface abstraction is less needed compared to statically typed and / or object oriented languages, it can be handy in certain contexts, such as when implementing "Ports and Adapters" (also known as "Hexagon") architecture, which was the main motivation for the creation of this library.</p>
</div>
<div class="sect2">
<h3 id="_maven_dependencies_2">Maven dependencies</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&lt;dependency&gt;
    &lt;groupId&gt;com.github.arvyy.kawa-web-collection&lt;/groupId&gt;
    &lt;artifactId&gt;interface&lt;/artifactId&gt;
    &lt;packaging&gt;kawalib&lt;/packaging&gt;
    &lt;version&gt;0.0.1&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_exported_procedures_2">Exported procedures</h3>
<div class="sect3">
<h4 id="_library_arvyy_interface">Library <code>(arvyy interface)</code></h4>
<div class="paragraph">
<p>Interface is defined with</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>(define-interface
  interface-implementation-constructor
  method-signature ...)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where <code>method-signature</code> is either</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>(method-name arg &#8230;&#8203;)</code></p>
</li>
<li>
<p><code>(method-name arg &#8230;&#8203; . rest)</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>(define-interface
  foo
  (bar arg1 arg2))</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>interface-implementation-constructor</code> is bound to syntax for constructing implementation of this interface, which shall be used so</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>(interface-implementation-constructor
    (method-signature method-body) ...)</code></pre>
</div>
</div>
<div class="paragraph">
<p>For example (using <code>foo</code> interface from above),</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>(define foo-impl
  (foo
    ((bar arg1 arg2) (list arg1 arg2))))</code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally, to invoke interface&#8217;s method, call it by supplying implementation instance as a first parameter</p>
</div>
<div class="paragraph">
<p>For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>(display (bar foo-impl 1 2)) ;; should show "(1 2)"</code></pre>
</div>
</div>
<div class="paragraph">
<p>During construction of implementation instance, the syntax verifies that</p>
</div>
<div class="ulist">
<ul>
<li>
<p>implementation provides same amount of methods, in same order, with same method names (parameter names are not checked)</p>
</li>
<li>
<p>each method provides call-compatible amount of arguments. Implementation method cannot declare more required arguments than there were in interface declaration. The method may declare less required arguments if it also provides a <code>rest</code> argument.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_mustache_templating">Mustache templating</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This library implements version 1.2.1 of the mustache spec. For general semantics, see <a href="https://mustache.github.io/mustache.5.html" class="bare">https://mustache.github.io/mustache.5.html</a></p>
</div>
<div class="sect2">
<h3 id="_maven_dependencies_3">Maven dependencies</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&lt;dependency&gt;
    &lt;groupId&gt;com.github.arvyy.kawa-web-collection&lt;/groupId&gt;
    &lt;artifactId&gt;mustache&lt;/artifactId&gt;
    &lt;packaging&gt;kawalib&lt;/packaging&gt;
    &lt;version&gt;0.0.1&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_base_usage">Base usage</h3>
<div class="paragraph">
<p><code>(import (arvyy mustache))</code></p>
</div>
<div class="paragraph">
<p>First, templates need to be compiled, using one of following ways.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>(compile root partial-locator)</code>. Here <code>root</code> should be a string of the "root" partial which will be the entry point
during execution. <code>partial-locator</code> must be a procedure, that accepts partial&#8217;s name as a single argument, and returns either #f if it cannot be found, or string or textual input port.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>(define (locator name)
  (cond
    ((string=? name "root") "Hello {{&gt;foo}}")
    ((string=? name "foo") "{{world}}")
    (else #f))
(define hello-world-compiled (compile "root" locator))</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>(compile template)</code>. Compiles given template string.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>(define hello-world-compiled (compile "Hello {{world}}"))</code></pre>
</div>
</div>
<div class="paragraph">
<p>Compiled template can be executed using</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>(execute compilation data out)</code>. <code>compilation</code> is result of <code>compile</code> invokation; <code>data</code> is the root object for interpolations; <code>out</code> is a textual output port, to which result will be writen. Returns unspecified value</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>(call-with-output-file "result.txt"
                       (lambda (out)
                         (execute hello-world-compiled
                                  '((world . "Scheme"))
                                   out)))</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>(execute compilation data)</code>. Instead of writing to a port, returns interpolated string result as a function value.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>(display (execute hello-world-compiled '((world . "Scheme"))))</code></pre>
</div>
</div>
<div class="paragraph">
<p>By default, vectors and streams are accepted for list interpolation, alists for object field lookup, data values are writen as with <code>display</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_behavior_customization">Behavior customization</h3>
<div class="paragraph">
<p>Behavior can be altered by use of parameterization.</p>
</div>
<div class="sect3">
<h4 id="_field_lookup_in_object">Field lookup in object</h4>
<div class="paragraph">
<p>Lookup is a procedure, that finds corresponding value given an object and a fragment (fragment being elements of list after splitting tag name by <code>.</code>), of the following form</p>
</div>
<div class="paragraph">
<p><code>(lookup object name found not-found)</code>. Object is currently examined datum; name is a fragment / field of string type; found is a function that should be invoked in tail position if field was found in the object with corresponding value as an argument; not-found is a 0 argument function that should be invoked in tail position if field was not found in the object, or if the object cannot be inspected with this lookup function.</p>
</div>
<div class="paragraph">
<p>For example, creating a lookup for a record type:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>(define-record-type &lt;foo&gt; (foo bar) foo? (bar foo-bar))
(define (foo-lookup obj name found not-found)
  (cond
    ((not (foo? obj)) (not-found))
    ((string=? "bar" name) (found (foo-bar obj)))
    (else (not-found))))</code></pre>
</div>
</div>
<div class="paragraph">
<p>Use <code>compose-lookups</code> to merge multiple lookup implementations into one:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>(define alist+foo (compose-lookups alist-lookup foo-lookup))</code></pre>
</div>
</div>
<div class="paragraph">
<p>When composed, each lookup is tried to be applied to the object until one of lookups invokes <code>found</code>, in given order. If all lookups return not-found, then composition also returns not-found</p>
</div>
<div class="paragraph">
<p>The lookup used during execution is retrieved from <code>current-lookup</code> parameter. It defaults to <code>alist-lookup</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_collection">Collection</h4>
<div class="paragraph">
<p>Collection is a reference to a set of methods of an iterable multivalue object type, which is used to expand sections. Collection is created with</p>
</div>
<div class="paragraph">
<p><code>(collection pred?-proc empty?-proc for-each-proc)</code> where <code>pred?-proc</code> is a predicate for given collection, <code>empty?-proc</code> is procedure returning if given collection is empty, <code>for-each-proc</code> is a procedure that given a one argument function and this collection, executes given function for each element.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>(define list-collection (collection list? null? for-each))</code></pre>
</div>
</div>
<div class="paragraph">
<p>Use <code>compose-collections</code> to merge multiple collections into one</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>(define vec+list (compose-collections vector-collection list-collection))</code></pre>
</div>
</div>
<div class="paragraph">
<p>The collection used during execution is retrieved from <code>current-collection</code> parameter. It defaults to <code>(compose-collections vector-collection stream-collection)</code>. While the library does export <code>list-collection</code>, it is not used by default as to not clash with alist lookup for objects.</p>
</div>
</div>
<div class="sect3">
<h4 id="_value_writing">Value writing</h4>
<div class="paragraph">
<p>Writer is a procedure of form</p>
</div>
<div class="paragraph">
<p><code>(writer obj out)</code> where obj is a scheme object, and out is textual output port. Writer should write appropriate representation of obj to out.</p>
</div>
<div class="paragraph">
<p>The writer used during execution is retrieved from <code>current-writer</code> parameter. It defaults to <code>(lambda (obj out) (when obj (display obj out)))</code>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_slf4j_logging_api">SLF4J logging API</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Module for using logging APIs.</p>
</div>
<div class="sect2">
<h3 id="_maven_dependencies_4">Maven dependencies</h3>
<div class="paragraph">
<p>To include module itself, add following dependency.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&lt;dependency&gt;
    &lt;groupId&gt;com.github.arvyy.kawa-web-collection&lt;/groupId&gt;
    &lt;artifactId&gt;slf4j&lt;/artifactId&gt;
    &lt;packaging&gt;kawalib&lt;/packaging&gt;
    &lt;version&gt;0.0.1&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note, however, this alone is not enough. SLF4J is an API, it&#8217;s a frontend providing endpoints to log things,
however you&#8217;d also need to include one of loggers that provide SLF4J implementation. For development / tests, you can use simple implementation</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&lt;dependency&gt;
    &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
    &lt;artifactId&gt;slf4j-simple&lt;/artifactId&gt;
    &lt;version&gt;1.7.30&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>For production uses however, you should look into using log4j or logback implementations.</p>
</div>
</div>
<div class="sect2">
<h3 id="_exported_procedures_3">Exported procedures</h3>
<div class="sect3">
<h4 id="_library_arvyy_slf4j">Library <code>(arvyy slf4j)</code></h4>
<div class="paragraph">
<p><code>(get-logger name) &#8594; logger</code></p>
</div>
<div class="paragraph">
<p>create a logger by name.</p>
</div>
<div class="paragraph">
<p><code>(logger-name logger) &#8594; name</code></p>
</div>
<div class="paragraph">
<p>return logger&#8217;s name. <code>logger</code> is a logger constructed with <code>get-logger</code>.</p>
</div>
<div class="paragraph">
<p><code>(log-trace logger message arg &#8230;&#8203;)</code></p>
</div>
<div class="paragraph">
<p><code>(log-debug logger message arg &#8230;&#8203;)</code></p>
</div>
<div class="paragraph">
<p><code>(log-info logger message arg &#8230;&#8203;)</code></p>
</div>
<div class="paragraph">
<p><code>(log-warn logger message arg &#8230;&#8203;)</code></p>
</div>
<div class="paragraph">
<p><code>(log-error logger message arg &#8230;&#8203;)</code></p>
</div>
<div class="paragraph">
<p>log a message at appropriate level. <code>logger</code> is a logger constructed with <code>get-logger</code>. <code>message</code> is a string to be logged. The string may have placeholders
<code>{}</code> which would be substituted by <code>arg</code> value. The last <code>arg</code> which isn&#8217;t matching a <code>{}</code> may be an error object (as caught by <code>with-excption-handler</code>).
Note that these are macros - each <code>arg</code> may be a resource intensive expression, which will only be evaluated if appropriate logging level is enabled.</p>
</div>
<div class="paragraph">
<p><code>(trace-enabled? logger) &#8594; boolean</code></p>
</div>
<div class="paragraph">
<p><code>(debug-enabled? logger) &#8594; boolean</code></p>
</div>
<div class="paragraph">
<p><code>(info-enabled? logger) &#8594; boolean</code></p>
</div>
<div class="paragraph">
<p><code>(warn-enabled? logger) &#8594; boolean</code></p>
</div>
<div class="paragraph">
<p><code>(error-enabled? logger) &#8594; boolean</code></p>
</div>
<div class="paragraph">
<p>determine if specified logging level is enabled. <code>logger</code> is a logger constructed with <code>get-logger</code>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_solrj">Solrj</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Module for interacting with Solr. A thin wrapper of Solrj.
If you wish to use embedded solr, add <code>solr-embedded</code> module.</p>
</div>
<div class="sect2">
<h3 id="_maven_dependencies_5">Maven dependencies</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&lt;dependency&gt;
    &lt;groupId&gt;com.github.arvyy.kawa-web-collection&lt;/groupId&gt;
    &lt;artifactId&gt;solrj&lt;/artifactId&gt;
    &lt;packaging&gt;kawalib&lt;/packaging&gt;
    &lt;version&gt;0.0.1&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_exported_procedures_4">Exported procedures</h3>
<div class="sect3">
<h4 id="_library_arvyy_solrj">Library <code>(arvyy solrj)</code></h4>
<div class="paragraph">
<p><code>(create-http-solr-client url) &#8594; solr-client</code></p>
</div>
<div class="paragraph">
<p>create a client, that connects to solr server running at given url.</p>
</div>
<div class="paragraph">
<p><code>commit-within</code></p>
</div>
<div class="paragraph">
<p>a parameter (used through <code>parameterize</code> form) controlling <code>commitWithin</code> solr parameter when calling <code>add</code>, <code>query</code>, <code>delete-by-query</code>, <code>delete-by-id</code>.
See <a href="https://solr.apache.org/guide/6_6/updatehandlers-in-solrconfig.html#UpdateHandlersinSolrConfig-commitWithin" class="bare">https://solr.apache.org/guide/6_6/updatehandlers-in-solrconfig.html#UpdateHandlersinSolrConfig-commitWithin</a> .</p>
</div>
<div class="paragraph">
<p><code>(commit core)</code></p>
</div>
<div class="paragraph">
<p><code>(rollback core)</code></p>
</div>
<div class="paragraph">
<p>force commit / rollback for a given core. <code>core</code> is a core name as a string.</p>
</div>
<div class="paragraph">
<p><code>(add solr-client core docs)</code></p>
</div>
<div class="paragraph">
<p>Add documents to solr index. <code>core</code> is a core name as a string. <code>docs</code> is a vector of documents, where
each document is an alist using symbol as a key.</p>
</div>
<div class="paragraph">
<p><code>(query solr-client core handler params) &#8594; solr-result</code></p>
</div>
<div class="paragraph">
<p>Execute solr query, returning json response in sexpr form as defined in srfi 180. <code>core</code> is a core name as a string.
<code>handler</code> is request handler name as a string. <code>params</code> is an alist of parameters to be passed to query, using symbols as keys, and strings, integers, or vector of the later as values.</p>
</div>
<div class="paragraph">
<p><code>(delete-by-query solr-client core query)</code></p>
</div>
<div class="paragraph">
<p>Delete solr documents matching the query. <code>core</code> is a core name as a string. <code>query</code> is a string of lucene
query syntax, defining what to delete.</p>
</div>
<div class="paragraph">
<p><code>(delete-by-id solr-client core ids)</code></p>
</div>
<div class="paragraph">
<p>Delete solr documents with given ids. <code>core</code> is a core name as a string. <code>ids</code> is a vector of strings of documents to delete.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_solr_embedded">Solr embedded</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Module for embeddeding Solr.
For interaction with with it, see <code>solrj</code> module.</p>
</div>
<div class="sect2">
<h3 id="_maven_dependencies_6">Maven dependencies</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&lt;dependency&gt;
    &lt;groupId&gt;com.github.arvyy.kawa-web-collection&lt;/groupId&gt;
    &lt;artifactId&gt;solr-embedded&lt;/artifactId&gt;
    &lt;packaging&gt;kawalib&lt;/packaging&gt;
    &lt;version&gt;0.0.1&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_exported_procedures_5">Exported procedures</h3>
<div class="sect3">
<h4 id="_library_arvyy_solrj_2">Library <code>(arvyy solrj)</code></h4>
<div class="paragraph">
<p><code>(create-embedded-solr-client solrhome default-core) &#8594; solr-client</code></p>
</div>
<div class="paragraph">
<p>create a client that wraps embedded lucene index. <code>solrhome</code> is path as a string to solr home folder containing solr configuration. <code>default-core</code> specifies core name that acts as a default.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_spark_web_server">Spark web server</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Module provides http server functionality. Thin wrapper over sparkjava.</p>
</div>
<div class="sect2">
<h3 id="_maven_dependencies_7">Maven dependencies</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&lt;dependency&gt;
    &lt;groupId&gt;com.github.arvyy.kawa-web-collection&lt;/groupId&gt;
    &lt;artifactId&gt;spark&lt;/artifactId&gt;
    &lt;packaging&gt;kawalib&lt;/packaging&gt;
    &lt;version&gt;0.0.1&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_exported_procedures_6">Exported procedures</h3>
<div class="sect3">
<h4 id="_library_arvyy_kawa_spark">Library <code>(arvyy kawa-spark)</code></h4>
<div class="paragraph">
<p>In all occurances below, <code>route</code> corresponds to a procedure parameter, that takes two arguments - request and response objects - and returns a value to be used in response.
In all occurances below, <code>filter</code> corresponds to a procedure parameter, that takes two arguments - request and response objects - interacts with them in some way, but returns unspecified value.
In all occurances below, <code>req</code> corresponds to a request object, provided as the first argument to <code>route</code> or <code>filter</code>.
In all occurances below, <code>resp</code> corresponds to a response object, provided as the second argument to <code>route</code> or <code>filter</code>.
In all occurances below, <code>session</code> corresponds to a session object, retrieved through <code>req/session</code> / <code>req/create-session!</code>.</p>
</div>
<div class="paragraph">
<p><code>(get path route)</code></p>
</div>
<div class="paragraph">
<p><code>(post path route)</code></p>
</div>
<div class="paragraph">
<p><code>(put path route)</code></p>
</div>
<div class="paragraph">
<p><code>(delete path route)</code></p>
</div>
<div class="paragraph">
<p><code>(options path route)</code></p>
</div>
<div class="paragraph">
<p>Add a controller mapping for a GET / POST / PUT / DELETE / OPTIONS method. <code>path</code> is a path as a string.</p>
</div>
<div class="paragraph">
<p><code>(before-all filter)</code></p>
</div>
<div class="paragraph">
<p><code>(after-all filter)</code></p>
</div>
<div class="paragraph">
<p><code>(after-after-all filter)</code></p>
</div>
<div class="paragraph">
<p>Execute filter before / after / very-after ("finally" block) for any request.</p>
</div>
<div class="paragraph">
<p><code>(before path filter)</code></p>
</div>
<div class="paragraph">
<p><code>(after path filter)</code></p>
</div>
<div class="paragraph">
<p><code>(after-after path filter)</code></p>
</div>
<div class="paragraph">
<p>Execute filter before / after / very-after ("finally" block) for requests to a given path. <code>path</code> is a path as a string.</p>
</div>
<div class="paragraph">
<p><code>(redirect/get from to)</code></p>
</div>
<div class="paragraph">
<p><code>(redirect/post from to)</code></p>
</div>
<div class="paragraph">
<p><code>(redirect from to)</code></p>
</div>
<div class="paragraph">
<p>Redirect GET / POST / any requests coming through <code>from</code> path towards <code>to</code>. <code>from</code> and <code>to</code> are paths as strings.</p>
</div>
<div class="paragraph">
<p><code>(path path body &#8230;&#8203;)</code></p>
</div>
<div class="paragraph">
<p>Mappings defined in <code>body</code> will have <code>path</code> prefix added to them. <code>path</code> is path as a string. <code>body &#8230;&#8203;</code> are statements to be wrapped in a lambda.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scheme" data-lang="scheme">(path "rest"
    (get "foo" (lambda (req resp) ;; maps to /rest/foo
                  ...)))</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>(req/attributes req)</code></p>
</div>
<div class="paragraph">
<p>Get request attributes as list of strings.</p>
</div>
<div class="paragraph">
<p><code>(req/attribute req attr)</code></p>
</div>
<div class="paragraph">
<p>Get attribute value. <code>attr</code> is attribute name as a string.</p>
</div>
<div class="paragraph">
<p><code>(req/set-attribute! req attr value)</code></p>
</div>
<div class="paragraph">
<p>Set attribute value. <code>attr</code> is attribute name as a string. <code>value</code> is any value.</p>
</div>
<div class="paragraph">
<p><code>(req/body req)</code></p>
</div>
<div class="paragraph">
<p>Get request body as a string.</p>
</div>
<div class="paragraph">
<p><code>(req/body-as-bytes req)</code></p>
</div>
<div class="paragraph">
<p>Get request body as a vector of bytes.</p>
</div>
<div class="paragraph">
<p><code>(req/content-length req)</code></p>
</div>
<div class="paragraph">
<p>Get request length in bytes as an integer.</p>
</div>
<div class="paragraph">
<p><code>(req/content-type req)</code></p>
</div>
<div class="paragraph">
<p>Get request content-type as a string.</p>
</div>
<div class="paragraph">
<p><code>(req/context-path req)</code></p>
</div>
<div class="paragraph">
<p>Get request context-path as a string.</p>
</div>
<div class="paragraph">
<p><code>(req/cookies req)</code></p>
</div>
<div class="paragraph">
<p>Get request cookies as an alist.</p>
</div>
<div class="paragraph">
<p><code>(req/cookie req name)</code></p>
</div>
<div class="paragraph">
<p>Get a cookie by name as a string.</p>
</div>
<div class="paragraph">
<p><code>(req/headers req)</code></p>
</div>
<div class="paragraph">
<p>Get a list of header names present in request.</p>
</div>
<div class="paragraph">
<p><code>(req/header req name)</code></p>
</div>
<div class="paragraph">
<p>Get value for the provided header as a string.</p>
</div>
<div class="paragraph">
<p><code>(req/host req)</code></p>
</div>
<div class="paragraph">
<p>Get host as a string.</p>
</div>
<div class="paragraph">
<p><code>(req/ip req)</code></p>
</div>
<div class="paragraph">
<p>Get IP as a string.</p>
</div>
<div class="paragraph">
<p><code>(req/params req)</code></p>
</div>
<div class="paragraph">
<p>Get params of the request as an alist. Param here refers to path variables encoded in the form of <code>:name</code>, for example</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scheme" data-lang="scheme">;;  matches "GET /rest/users/u1"
(get "/rest/users/:id"
     (lambda (req resp)
       (define p (req/params req)) ;; ((":id" . "u1"))
       ...
     ))</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>(req/param req name)</code></p>
</div>
<div class="paragraph">
<p>Get param of the request for given name as a string.</p>
</div>
<div class="paragraph">
<p><code>(req/path-info req)</code></p>
</div>
<div class="paragraph">
<p>Get path info as a string.</p>
</div>
<div class="paragraph">
<p><code>(req/port req)</code></p>
</div>
<div class="paragraph">
<p>Get port as an integer.</p>
</div>
<div class="paragraph">
<p><code>(req/protocol req)</code></p>
</div>
<div class="paragraph">
<p>Get protocol as a string.</p>
</div>
<div class="paragraph">
<p><code>(req/query-string req)</code></p>
</div>
<div class="paragraph">
<p>Get a query string (ie., the bit after <code>?</code>) as a string.</p>
</div>
<div class="paragraph">
<p><code>(req/query-params req)</code></p>
</div>
<div class="paragraph">
<p>Get query param names present in request as a list of strings.</p>
</div>
<div class="paragraph">
<p><code>(req/query-param req name)</code></p>
</div>
<div class="paragraph">
<p>Get first value for a given query parameter as a string.</p>
</div>
<div class="paragraph">
<p><code>(req/query-param-values req)</code></p>
</div>
<div class="paragraph">
<p>Get all values for a given query parameter (ie., when parameter is repeated multiple times) as a list of strings.</p>
</div>
<div class="paragraph">
<p><code>(req/request-method req)</code></p>
</div>
<div class="paragraph">
<p>Get HTTP method as a string.</p>
</div>
<div class="paragraph">
<p><code>(req/scheme req)</code></p>
</div>
<div class="paragraph">
<p>Get scheme as a string.</p>
</div>
<div class="paragraph">
<p><code>(req/session req)</code></p>
</div>
<div class="paragraph">
<p>Get session object, if session had been created. Returns #f if it wasn&#8217;t.</p>
</div>
<div class="paragraph">
<p><code>(req/create-session! req)</code></p>
</div>
<div class="paragraph">
<p>Get session object; creates the session if it didn&#8217;t exist.</p>
</div>
<div class="paragraph">
<p><code>(req/splat req)</code></p>
</div>
<div class="paragraph">
<p>Get splat of the request as a list of strings. Splat here refers to path variables encoded in the form of <code>*</code>, for example</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scheme" data-lang="scheme">;;  matches "GET /rest/foo/bar/baz"
(get "/rest/*/bar/*"
     (lambda (req resp)
       (define s (req/splat req)) ;; ("foo" "baz")
       ...
     ))</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>(req/uri req)</code></p>
</div>
<div class="paragraph">
<p>Get request URI as a string.</p>
</div>
<div class="paragraph">
<p><code>(req/url req)</code></p>
</div>
<div class="paragraph">
<p>Get request URL as a string.</p>
</div>
<div class="paragraph">
<p><code>(req/user-agent req)</code></p>
</div>
<div class="paragraph">
<p>Get user agent as a string.</p>
</div>
<div class="paragraph">
<p><code>(resp/body resp)</code></p>
</div>
<div class="paragraph">
<p>Get response body as string.</p>
</div>
<div class="paragraph">
<p><code>(resp/set-body! resp body)</code></p>
</div>
<div class="paragraph">
<p>Set response body as string.</p>
</div>
<div class="paragraph">
<p><code>(resp/set-header! resp name value)</code></p>
</div>
<div class="paragraph">
<p>Set response header.</p>
</div>
<div class="paragraph">
<p><code>(resp/redirect resp location)</code></p>
</div>
<div class="paragraph">
<p>Mark response to do a redirect to a location.</p>
</div>
<div class="paragraph">
<p><code>(resp/status resp)</code></p>
</div>
<div class="paragraph">
<p>Get response status code as an integer.</p>
</div>
<div class="paragraph">
<p><code>(resp/set-status! resp status-code)</code></p>
</div>
<div class="paragraph">
<p>Set response status code as an integer.</p>
</div>
<div class="paragraph">
<p><code>(resp/type resp)</code></p>
</div>
<div class="paragraph">
<p>Get response content type as a string.</p>
</div>
<div class="paragraph">
<p><code>(resp/set-type! resp type)</code></p>
</div>
<div class="paragraph">
<p>Set response content type as a string.</p>
</div>
<div class="paragraph">
<p><code>(resp/set-cookie! resp name value)</code></p>
</div>
<div class="paragraph">
<p>Set cookie for the response.</p>
</div>
<div class="paragraph">
<p><code>(resp/remove-cookie! resp name)</code></p>
</div>
<div class="paragraph">
<p>Remove cookie by name from response.</p>
</div>
<div class="paragraph">
<p><code>(session/attribute session name)</code></p>
</div>
<div class="paragraph">
<p>Get attribute value from session by name.</p>
</div>
<div class="paragraph">
<p><code>(session/set-attribute! session name value)</code></p>
</div>
<div class="paragraph">
<p>Set session attribute value.</p>
</div>
<div class="paragraph">
<p><code>(session/remove-attribute! session name)</code></p>
</div>
<div class="paragraph">
<p>Remove session attribute.</p>
</div>
<div class="paragraph">
<p><code>(session/attributes session)</code></p>
</div>
<div class="paragraph">
<p>Get attribute names present in session as a list of strings.</p>
</div>
<div class="paragraph">
<p><code>(session/id session)</code></p>
</div>
<div class="paragraph">
<p>Get session unique id as a string.</p>
</div>
<div class="paragraph">
<p><code>(session/new? session)</code></p>
</div>
<div class="paragraph">
<p>Returns true if the session hadn&#8217;t been communicated with client yet</p>
</div>
<div class="paragraph">
<p><code>(halt! code message)</code></p>
</div>
<div class="paragraph">
<p>Halt current request with given <code>code</code> status code as an integer, <code>message</code> as a string.</p>
</div>
<div class="paragraph">
<p><code>(not-found route)</code></p>
</div>
<div class="paragraph">
<p>Handle request which didn&#8217;t match any handler.</p>
</div>
<div class="paragraph">
<p><code>(internal-server-error route)</code></p>
</div>
<div class="paragraph">
<p>Handle request which caused server-side error.</p>
</div>
<div class="paragraph">
<p><code>(exception handler)</code></p>
</div>
<div class="paragraph">
<p>Handle request which raised an exception. <code>handler</code> is like <code>route</code>, except it has an extra parameter in first position <code>exception</code>, corresponding to the raised object.</p>
</div>
<div class="paragraph">
<p><code>(static-files/location folder)</code></p>
</div>
<div class="paragraph">
<p>Enable serving static files from <code>folder</code> as a string relative to classpath (ie, inside src/main/resources).</p>
</div>
<div class="paragraph">
<p><code>(static-files/external-location folder)</code></p>
</div>
<div class="paragraph">
<p>Enable serving static files from file system from <code>folder</code> location as a string.</p>
</div>
<div class="paragraph">
<p><code>(static-files/expire-time seconds)</code></p>
</div>
<div class="paragraph">
<p>Set expire timing for static resources in seconds as an integer.</p>
</div>
<div class="paragraph">
<p><code>(static-files/header key value)</code></p>
</div>
<div class="paragraph">
<p>Append given header when serving static resources.</p>
</div>
<div class="paragraph">
<p><code>(init)</code></p>
</div>
<div class="paragraph">
<p>Manually start the server (The server is automatically started when you do something that requires the server to be started, and thus usually isn&#8217;t needed).</p>
</div>
<div class="paragraph">
<p><code>(stop)</code></p>
</div>
<div class="paragraph">
<p>Stop the server.</p>
</div>
<div class="paragraph">
<p><code>(port value)</code></p>
</div>
<div class="paragraph">
<p>Set port on which to run server. Must be done before declaring routes and filters. Defaults to 4567.</p>
</div>
<div class="paragraph">
<p><code>(secure keystoreFilePath keystorePassword truststoreFilePath truststorePassword)</code></p>
</div>
<div class="paragraph">
<p>Secure server with SSL. Must be done before declaring routes and filters.</p>
</div>
<div class="paragraph">
<p><code>(thread-pool count)</code></p>
</div>
<div class="paragraph">
<p>Configure threadpool specifying the amount of threads.</p>
</div>
<div class="paragraph">
<p><code>(await-initialization)</code></p>
</div>
<div class="paragraph">
<p>Block until server is ready</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_password_encoder">Password encoder</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Module to cryptographically encode and compare passwords or other sensitive data. Thin wrapper over spring security crypto library.</p>
</div>
<div class="sect2">
<h3 id="_maven_dependencies_8">Maven dependencies</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&lt;dependency&gt;
    &lt;groupId&gt;com.github.arvyy.kawa-web-collection&lt;/groupId&gt;
    &lt;artifactId&gt;spring-password-encoder&lt;/artifactId&gt;
    &lt;packaging&gt;kawalib&lt;/packaging&gt;
    &lt;version&gt;0.0.1&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_exported_procedures_7">Exported procedures</h3>
<div class="sect3">
<h4 id="_library_arvyy_spring_password_encoder">Library <code>(arvyy spring-password-encoder)</code></h4>
<div class="paragraph">
<p><code>(encode-password password-encoder password) &#8594; encoded-password</code></p>
</div>
<div class="paragraph">
<p>encodes given password and returns it as a string. <code>password-encoder</code> is an encoder instantiated with one of <code>make-*-password-encoder</code> procedures below. <code>password</code> is a password as a string.</p>
</div>
<div class="paragraph">
<p>Note that generally speaking, <code>encode-password</code> isn&#8217;t referentially transparent and may return different results with same inputs (due to generating and using a different salt). Therefore this procedure is only useable for encoding, but not comparing. See <code>passwords-match</code> for validating user supplied password with stored password.</p>
</div>
<div class="paragraph">
<p><code>(passwords-match password-encoder raw-password encoded-password) &#8594; matches?</code></p>
</div>
<div class="paragraph">
<p>compares given raw password with an encoded password, and returns whether they match as a boolean. <code>password-encoder</code> is an encoder instantiated with one of <code>make-*-password-encoder</code> procedures below. <code>raw-password</code> is a raw password as a string. <code>encoded-password</code> is a previously encoded password by an encoder as a string.</p>
</div>
<div class="paragraph">
<p><code>(make-pbkdf2-password-encoder) &#8594; password-encoder</code></p>
</div>
<div class="paragraph">
<p><code>(make-pbkdf2-password-encoder secret) &#8594; password-encoder</code></p>
</div>
<div class="paragraph">
<p><code>(make-pbkdf2-password-encoder secret salt-length) &#8594; password-encoder</code></p>
</div>
<div class="paragraph">
<p><code>(make-pbkdf2-password-encoder secret iterations hash-width) &#8594; password-encoder</code></p>
</div>
<div class="paragraph">
<p><code>(make-pbkdf2-password-encoder secret salt-length iterations hash-width) &#8594; password-encoder</code></p>
</div>
<div class="paragraph">
<p>Constructs pbkdf2 based password encoder.</p>
</div>
<div class="paragraph">
<p><code>(make-bcrypt-password-encoder [strength]) &#8594; password-encoder</code></p>
</div>
<div class="paragraph">
<p>Constructs bcrypt based password encoder.</p>
</div>
<div class="paragraph">
<p><code>(make-scrypt-password-encoder [cpu-cost mem-cost parallelization key-length salt-length]) &#8594; password-encoder</code></p>
</div>
<div class="paragraph">
<p>Constructs scrypt based password encoder.</p>
</div>
<div class="paragraph">
<p><code>(make-argon2-password-encoder [salt-length hash-length parallelization memory iterations]) &#8594; password-encoder</code></p>
</div>
<div class="paragraph">
<p>Constructs argon2 based password encoder.</p>
</div>
<div class="paragraph">
<p><code>(make-custom-password-encoder encode-proc matches-proc) &#8594; password-encoder</code></p>
</div>
<div class="paragraph">
<p>Constructs a custom password encoder. <code>encoder-proc</code> must be a procedure that takes raw password as a string and returns encoded password as a string. <code>matches-proc</code> must be a procedure that takes raw password as a string, encoded password as a string, and returns boolean whether or not passwords match.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_srfi_180_json">SRFI 180 (json)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Plain SRFI 180 reference implementation for using json.</p>
</div>
<div class="sect2">
<h3 id="_maven_dependencies_9">Maven dependencies</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&lt;dependency&gt;
    &lt;groupId&gt;com.github.arvyy.kawa-web-collection&lt;/groupId&gt;
    &lt;artifactId&gt;srfi-180&lt;/artifactId&gt;
    &lt;packaging&gt;kawalib&lt;/packaging&gt;
    &lt;version&gt;0.0.1&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_exported_procedures_8">Exported procedures</h3>
<div class="paragraph">
<p>For details, please see <a href="https://srfi.schemers.org/srfi-180/srfi-180.html" class="bare">https://srfi.schemers.org/srfi-180/srfi-180.html</a> .</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_wishlist">Wishlist</h2>
<div class="sectionbody">
<div class="paragraph">
<p>These are some of the modules that will hopefuly find their way to be included into this collection with time:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>REST client</p>
</li>
<li>
<p>JWT library</p>
</li>
<li>
<p>Email sender</p>
</li>
<li>
<p>Excel (Apache POI) integration</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2022-06-23 01:58:41 +0300
</div>
</div>
</body>
</html>